resources:
  jobs:
    DAE00193:
      name: DAE00193
      job_clusters:
      - job_cluster_key: DAE00193_job_cluster
        new_cluster:
          spark_version: 15.4.x-scala2.12
          ' azure_attributes':
            first_on_demand: 1
            availability: SPOT_WITH_FALLBACK_AZURE
            spot_bid_max_price: '-1'
          node_type_id: Standard_D4ds_v5
          spark_env_vars:
            PYSPARK_PYTHON: /databricks/python3/bin/python3
          enable_elastic_disk: 'true'
          data_security_mode: USER_ISOLATION
          runtime_engine: STANDARD
          autoscale:
            min_workers: 2
            max_workers: 4
      git_source:
        git_url: https://github.com/Megha-jfs/walgreens.git
        git_provider: GITHUB
        git_branch: main
      tasks:
      - task_key: fetch_open_batch
        description: Check for open batch
        notebook_task:
          notebook_path: notebooks/fetch_open_batch
          source: GIT
        timeout_seconds: 120
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      - task_key: update_job_execution_detail_inprogress
        description: Mark job as inprogress
        notebook_task:
          notebook_path: notebooks/update_job_execution_detail
          source: GIT
          base_parameters:
            status: IN_PROGRESS
        depends_on:
        - task_key: fetch_open_batch
        timeout_seconds: 120
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      - task_key: sql_execution_300_rad_scm_daily_waterfall_refresh_dashboard_new
        description: Execute SQL for 300_rad_scm_daily_waterfall_refresh_dashboard_new
        notebook_task:
          notebook_path: notebooks/runner_main
          source: GIT
          base_parameters:
            notebook_path: /Workspace/Users/megha.upadhyay@walgreens.com/ProcessCtrlFramework/sqls/samplesqlscript0
        depends_on:
        - task_key: update_job_execution_detail_inprogress
        timeout_seconds: 7200
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      - task_key: sql_execution_300_rad_scm_daily_waterfall_refresh_dashboard_new_30_days
        description: Execute SQL for 300_rad_scm_daily_waterfall_refresh_dashboard_new_30_days
        notebook_task:
          notebook_path: notebooks/runner_main
          source: GIT
          base_parameters:
            notebook_path: /Workspace/Users/megha.upadhyay@walgreens.com/ProcessCtrlFramework/sqls/samplesqlscript1
        depends_on:
        - task_key: sql_execution_300_rad_scm_daily_waterfall_refresh_dashboard_new
        timeout_seconds: 7200
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      - task_key: sql_execution_300_rad_scm_daily_waterfall_refresh_wag_pick_ship
        description: Execute SQL for 300_rad_scm_daily_waterfall_refresh_wag_pick_ship
        notebook_task:
          notebook_path: notebooks/runner_main
          source: GIT
          base_parameters:
            notebook_path: /Workspace/Users/megha.upadhyay@walgreens.com/ProcessCtrlFramework/sqls/samplesqlscript2
        depends_on:
        - task_key: sql_execution_300_rad_scm_daily_waterfall_refresh_dashboard_new_30_days
        timeout_seconds: 7200
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      - task_key: sql_execution_300_rad_scm_daily_waterfall_refresh_dashboard_promo_flag
        description: Execute SQL for 300_rad_scm_daily_waterfall_refresh_dashboard_promo_flag
        notebook_task:
          notebook_path: notebooks/runner_main
          source: GIT
          base_parameters:
            notebook_path: /Workspace/Users/megha.upadhyay@walgreens.com/ProcessCtrlFramework/sqls/samplesqlscript3
        depends_on:
        - task_key: sql_execution_300_rad_scm_daily_waterfall_refresh_wag_pick_ship
        timeout_seconds: 7200
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      - task_key: sql_execution_300_rad_scm_daily_waterfall_refresh_dashboard_new_sf
        description: Execute SQL for 300_rad_scm_daily_waterfall_refresh_dashboard_new_sf
        notebook_task:
          notebook_path: notebooks/runner_main
          source: GIT
          base_parameters:
            notebook_path: /Workspace/Users/megha.upadhyay@walgreens.com/ProcessCtrlFramework/sqls/samplesqlscript4
        depends_on:
        - task_key: sql_execution_300_rad_scm_daily_waterfall_refresh_dashboard_promo_flag
        timeout_seconds: 7200
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      - task_key: update_job_execution_detail_completed
        description: Mark job as completed
        notebook_task:
          notebook_path: notebooks/update_job_execution_detail
          source: GIT
          base_parameters:
            status: COMPLETED
        depends_on:
        - task_key: sql_execution_300_rad_scm_daily_waterfall_refresh_dashboard_new_sf
        timeout_seconds: 120
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      parameters:
      - name: env
        default: dev
      - name: proj_id
        default: hadoop_mna_prod
      - name: dept_id
        default: mna_cooked_rad_scm
      - name: job_id
        default: 300_rad_scm_daily_waterfall_refresh_master
