resources:
  jobs:
    DAE00193:
      name: DAE00193
      parameters:
      - name: env
        default: dev
      - name: proj_id
        default: hadoop_mna_prod
      - name: dept_id
        default: mna_cooked_rad_scm
      - name: job_id
        default: 300_rad_scm_daily_waterfall_refresh_master
      tasks:
      - task_key: batch_check
        description: Check for open batch
        notebook_task:
          notebook_path: notebooks/fetch_open_batch
          source: GIT
          base_parameters: {}
        timeout_seconds: 120
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      - task_key: status_update_start
        description: Mark job as running
        notebook_task:
          notebook_path: notebooks/update_job_execution_detail
          source: GIT
          base_parameters:
            status: IN_PROGRESS
        depends_on:
        - task_key: batch_check
        timeout_seconds: 120
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      - task_key: execution_300_rad_scm_daily_waterfall_refresh_dashboard_new_30_days_1
        description: Execute task for 300_rad_scm_daily_waterfall_refresh_dashboard_new_30_days
        notebook_task:
          notebook_path: notebooks/runner_main
          source: GIT
          base_parameters:
            notebook_path: scripts/sqls/samplesqlscript1
        depends_on:
        - task_key: status_update_start
        timeout_seconds: 7200
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      - task_key: status_update_complete
        description: Mark job as completed
        notebook_task:
          notebook_path: notebooks/update_job_execution_detail
          source: GIT
          base_parameters:
            status: COMPLETED
        depends_on:
        - task_key: execution_300_rad_scm_daily_waterfall_refresh_dashboard_new_30_days_1
        timeout_seconds: 120
        retry_on_timeout: false
        job_cluster_key: DAE00193_job_cluster
      job_clusters:
      - job_cluster_key: DAE00193_job_cluster
        new_cluster:
          spark_version: 15.4.x-scala2.12
          azure_attributes:
            first_on_demand: 1
            availability: SPOT_WITH_FALLBACK_AZURE
            spot_bid_max_price: '-1'
          node_type_id: Standard_D4ds_v5
          spark_env_vars:
            PYSPARK_PYTHON: /databricks/python3/bin/python3
          enable_elastic_disk: 'true'
          data_security_mode: USER_ISOLATION
          runtime_engine: STANDARD
          autoscale:
            min_workers: 2
            max_workers: 4
      git_source:
        git_url: https://github.com/Megha-jfs/walgreens.git
        git_provider: GITHUB
        git_branch: main
